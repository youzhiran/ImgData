## win10 休眠与睡眠等电源选项详解

### 前言

亲爱的各位伙伴们，咕咕咕了一个多月，我又来写文章啦。

我们平常在使用win10的过程中有没有在关机的选项旁边注意到**休眠**和**睡眠**两个选项呢？



### win10支持的电源状态

win+r 输入 cmd 打开命令提示符，输入`powercfg /a`

![image-20200910114252962](E:\~MyFiles\Github\ImgData\2020.6\542\image-20200910114252962.png)

这里展示了电脑所支持的睡眠状态



除了我们常见的待机、休眠、快速启动外



### 休眠vs睡眠

**休眠（Hibernate）**

将系统切换到该模式后，系统会自动将内存中的数据全部转存到硬盘上一个休眠文件中，然后切断对所有设备的供电。这样当恢复的时候，系统会从硬盘上将休眠文件的内容直接读入内存，并恢复到休眠之前的状态。这种模式完全不耗电，因此不怕休眠后供电异常，但代价是需要一块和物理内存一样大小的硬盘空间（好在现在的硬盘已经跨越TB级别了，大容量硬盘越来越便宜）。而这种模式的恢复速度较慢，取决于内存大小和硬盘速度，一般都要1分钟左右，甚至更久。



**睡眠（Sleep）**

电脑睡眠是Windows Vista中的新模式，这种模式结合了待机和休眠的所有优点。将系统切换到睡眠状态后，系统会将内存中的数据全部转存到硬盘上的休眠文件中（这一点类似休眠），然后关闭除了内存外所有设备的供电，让内存中的数据依然维持着（这一点类似待机）。这样，当我们想要恢复的时候，如果在睡眠过程中供电没有发生过异常，就可以直接从内存中的数据恢复（类似待机），速度很快；但如果睡眠过程中供电异常，内存中的数据已经丢失了，还可以从硬盘上恢复（类似休眠），只是速度会慢一点。不过无论如何，这种模式都不会导致数据丢失。



**混合睡眠（hiber-sleep）**

是针对台式电脑推出的一种新的睡眠/休眠方法。该技术指睡眠（sleep）和休眠（hibernate）同时进行，也就是说，先把信息写到硬盘的hiberfil.sys文件中，再进行睡眠。如果没有终止外部供电，则睡眠，如终止外部供电，则再次开机时读取hiberfil.sys进行恢复，可以说整合了两者的优势：比起睡眠有防掉电的功能，且比起休眠在不终止外部供电的情况下启动速度更快。



**待机**

待机指的是电脑将当前处于运行状态的数du据保存在内存中，机器只对内存供电的状态；休眠指的是电脑在不使用的情况下将保存一份桌面及所有打开文件和文档的映像，然后可以直接断开电源。后续打开电源时，文件和文档就会按原来使用时的样子在桌面上还原打开。

S1指的是CPU停止工作，其他的硬件设备仍然正常工作的状态；S3指的是挂起到内存的状态，即把运行中的数据写入内存后关闭硬盘，电源仍然继续为内存等最必要的设备供电，以确保数据不丢失。

待机就是S3状态，电脑的内存仍然需要供电，所以不能关掉电源；

而休眠属于S4状态，内存信息写入硬盘，然后所有部件停止工作，电脑可以彻底关掉电源。



----------------------------

分别是S0到S5，它们代表的含义分别是：

S0--实际上这就是我们平常的工作状态，所有设备全开，功耗一般会超过80W；

S1--也称为POS（Power on Suspend），这时除了通过CPU时钟控制器将CPU关闭之外，其他的部件仍然正常工作，这时的功耗一般在30W以下；（其实有些CPU[降温软件](https://baike.baidu.com/item/降温软件)就是利用这种工作原理）

S2--这时CPU处于停止运作状态，总线时钟也被关闭，但其余的设备仍然运转；

S3--这就是我们熟悉的STR（Suspend to RAM），这时的功耗不超过10W；

S4--也称为STD（Suspend to Disk），这时系统主电源关闭，[硬盘存储](https://baike.baidu.com/item/硬盘存储)S4前数据信息，所以S4是比S3更省电状态.

S5--这种状态是最干脆的，就是连电源在内的所有设备全部关闭，即关机（shutdown），功耗为0。

我们最常用到的是S3状态，即Suspend to RAM（挂起到内存）状态，简称STR。顾名思义，STR就是把系统进入STR前的工作状态数据都存放到内存中去。在STR状态下，电源仍然继续为内存等最必要的设备供电，以确保数据不丢失，而其他设备均处于关闭状态，系统的耗电量极低。一旦我们按下Power按钮（主机电源开关），系统就被唤醒，马上从内存中读取数据并恢复到STR之前的工作状态。内存的读写速度极快，因此我们感到进入和离开STR状态所花费的时间不过是几秒钟而已；而S4状态，即STD（挂起到硬盘）与STR的原理是完全一样的，只不过数据是保存在硬盘中。由于硬盘的读写速度比内存要慢得多，因此用起来也就没有STR那么快了。STD的优点是只通过软件就能实现，比如Windows 2000就能在不支持STR的硬件上实现STD。

### 更改电源选项中的设置

2、在弹出的命令提示符窗口中输入：powercfg /h on 按下回车键；

###  睡眠状态研究

使用“powercfg /sleepstudy”命令来生成睡眠状态报告的html文件。

然后在浏览器浏览“file:///C:/Windows/system32/sleepstudy-report.html”这个地址可以看到如下：



### 参考资料

https://blog.csdn.net/arloor/article/details/84075181

https://baike.baidu.com/item/ACPI#5

### 扩展资料

https://www.zhihu.com/question/23014590/answer/474864577

https://zhuanlan.zhihu.com/p/114448236